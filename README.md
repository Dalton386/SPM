# Subtype-specific Pathway Linear Progression Model

An integer linear program for simultaneous identification of cancer pathways, cancer subtyes and subtype-specific order of pathway dysregulation. The input is the Cancer Cell Fraction (CCF) matrix with rows corresponding to samples and columns indicating somatic genetic variants for which CCF values are measured. The output consists of a partitioning samples into subtypes, a partitioning of variants into pathways, and a linear progression model of the pathways for each subtype.

About SPM
--
Our software SPM consists of three separate parts: intermediate file generation (matGenerator.cpp), the main algorithm implementation (SPM.R), and results interpretation (SPM_interpretation.R). Users are required to prepare an eligible gene alteration file as input, and then run these three scripts sequentially to acquire scrutable results. Detailed instructions can be found as follows.

Prepare Input
--
Users should prepare their dataset as a tab-delimited text file, with samples on the rows and genes on the columns, where each entry_(i,j) is the cancer cell fraction of gene j in sample i. For example, an eligible dataset of 10 samples and 4 genes could be in the following format:
```
0.4	0	0	0.2
0.4	0	0	0.2
0.4	0	0	0.2
0.4	0	0	0
0.4	0	0	0
0.4	0.2	0.2	0
0	0.2	0.4	0
0	0.2	0.4	0
0	0	0.4	0
0	0	0.4	0
```

Run matGenerator.cpp
--
To generate the intermediate constraint file, users should run matGenerator.cpp by providing user-defined parameters.
`K`: the expected size of pathways to discover;   
`T`: the expected number of subtypes to discover;   
`in`: input file name;    
`out`: intermediate constraint file name;   
`addrin`: the directory of input files;   
`addrout`: the directory of intermediate constraint files;    

Run SPM.R
--
SPM.R will read both input file and intermediate constraint file, and then generate aforementioned results by resolving a corresponding Integer Linear Programming problem. Users are responsible to provide the following parameters.
`ntree`: the same as `K`;   
`nptwy`: the same as `T`;   
`Tol`: the uncertainty to be introduced into the SPM model, range from 0 to 1;    
`in_filename`: the same as `in`;    
`int_filename`: the same as `out`;    
`out_filename`: output file name;   
`addrin`: same as the above;    
`addrint`: the same as matGenerator.cpp/`addrout`;    
`addrout`: the directory of output files;   
`control`: control parameters provided by Rcplex package;   

Run SPM_interpretation.R
--
SPM_interpretation.R will read results generated by SPM.R and provide scrutable interpretation for users. Required parameters are listed as follows:
`ntree`: same as the above;   
`nptwy`: same as the above;   
`Tol`: same as the above;   
`in_filename`: same as the above;   
`res_filename`: the same as SPM.R/`out_filename`;   
`addrin`: same as the above;    
`addrres`: the same as SPM.R/`addrout`;   

    
`More to be added...`
